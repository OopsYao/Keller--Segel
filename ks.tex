\documentclass{article}
\input{pitaya}

\title{Keller--Segel Notes}
\author{xyao}

\begin{document}
  \maketitle
  \section{Pseudo inverse function}
  Providing that partial derivatives of $V$ are switchable, and let $M\equiv 1 / V'$, we have that
  \begin{equation}
    \label{eq:rho t circ V}
    (\partial_t\rho)\circ V = -M(M\partial_t V)'.
  \end{equation}
  Plugging \cref{eq:rho t circ V} into the power-law nonlinear diffusion system
  \[
    \partial_t \rho = \left(D_{\rho}\rho^{\gamma - 1}\rho' - \chi\rho c'\right)'
  \]
  gives us
  \[
    \partial_t V = -\frac{D_\rho}{\gamma}(M^\gamma)' + \chi c'\circ V.
  \]

  \section{FEM}
  Given the basis $\{\phi_l\}$ of the finite subspace, the weak formulation of problem
  \[
    \left\{
      \begin{aligned}
        \partial_t c &= D_c \partial_x^2 c + R_c(\rho, c), \\
        \partial_x c &= 0\quad\text{at}\;\{a,b\}
      \end{aligned}
    \right.
  \]
  reads
  \begin{equation}
    \label{eq:sys2 weak form}
    \int_a^b \partial_t c \phi_l\diff x = - D_c\int_a^b \partial_x c\phi_l'\diff x
                                          + \int_a^b R_c(\rho, c)\phi_l\diff x,
  \end{equation}
  as
  \[
    \int_a^b \partial^2_x c\phi_l \diff x = - \int_a^b \partial_x c\phi_l'\diff x.
  \]

  Let $c(x, t) = \sum_k c_k(t)\phi_k(x)$, then \cref{eq:sys2 weak form} writes
  \[
    \sum_k c'_k(t)\int_a^b\phi_k\phi_l\diff x = - D_c\sum_k c_k(t)\int_a^b\phi_k'\phi_l'\diff x
                                                + \int_a^b R_c(\rho, c)\phi_l\diff x.
  \]

  \section{Implicit-explicit scheme}
  Suppose the PDE is $\partial_t y = f(y)$, where $f$ is an operator of $y$ (irrelevant to time
  variable $t$, not containing operations like $\partial_t$), then the scheme consists of two steps
  \[
    \left\{
      \begin{aligned}
        \frac{\tilde y - y}{\Delta t / 2} = f(\tilde y)\\
        \frac{T_{\Delta t}y - y}{\Delta t} = f(\tilde y),
      \end{aligned}
    \right.
  \]
  where $T_{\Delta t}y$ is the scheme approximation after time interval $\Delta t$.

  It is worth noting that the first step is implicit, so we apply the Newton's method to obtain
  the unknown intermediate state $\tilde y$. And if the operator $f$ contains terms that make
  it impossible to apply the Newton's method, we use $y$ instead.
\end{document}
