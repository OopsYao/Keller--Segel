\documentclass{article}
\input{pitaya}

\title{Keller--Segel Notes}
\author{xyao}

\newcommand{\bigo}{\mathcal O}

\begin{document}
  \maketitle
  \section{Splitting method}
  Consider the problem
  \[
    \partial_t\phi = A\phi,\quad t\in(t_n, t_{n + 1})
  \]
  where $A$ is an operator, then the solution writes $\phi_{t_{n + 1}} = \exp\{(t_{n + 1} - t_n)A\}
  \phi_{t_n} = \exp\{hA\}\phi_{t_n}$.
  If $A$ has decomposition $A = A_1 + A_2$, then $\exp\{h(A_1 + A_2)\}$ and $\exp\{hA_1\}\exp\{hA_2\}$
  inspire us to decouple the system to two subproblems,
  \[
    \begin{aligned}
      \partial_t\phi^* &= A_1\phi^*,&\quad\phi^{*}(t_n) &= \phi(t_n), \\
      \partial_t\phi^{**} &= A_2\phi^{**},&\quad \phi^{**}(t_n) &= \phi^{*}(t_{n + 1}).
    \end{aligned}
  \]

  The Taylor's expansion of the operator writes
  \[
    \mathrm e^{hA} = I + hA + \frac{h^2}2 A^2 + \bigo(h^3).
  \]
  So for the operator $\exp\{h(A_1 + A_2)\}$,
  \[
    \mathrm e^{h(A_1 + A_2)} = I + h(A_1 + A_2) + \frac{h^2}2 (A_1^2 + A_2^2 + A_1A_2 + A_2A_1) + \bigo(h^3),
  \]
  Consider the splitting operators,
  \[
    \begin{aligned}
      \mathrm e^{hA_2}\mathrm e^{hA_1}
      &= I + h(A_1 + A_2) + \frac{h^2}2 (A_1^2 + A_2^2 + 2A_2A_1) + \bigo(h^3), \\
      \mathrm e^{\frac h2A_1}\mathrm e^{hA_2}\mathrm e^{\frac h2A_1}
      &= I + h(A_1 + A_2) + \frac{h^2}2 (A_1^2 + A_2^2 + A_1A_2+ A_2A_1) + \bigo(h^3).
    \end{aligned}
  \]
  Hence the normal splitting and Strang splitting have a local truncation error of $\bigo(h^2)$
  and $\bigo(h^3)$,
  \[
    \begin{aligned}
      \mathrm e^{h(A_1 + A_2)} - \mathrm e^{hA_2}\mathrm e^{hA_1} &= \bigo(h^2), \\
      \mathrm e^{h(A_1 + A_2)} - \mathrm e^{\frac h2A_1}\mathrm e^{hA_2}\mathrm e^{\frac h2A_1}
                                                                  &= \bigo(h^3). \\
    \end{aligned}
  \]

  \section{Pseudo inverse function}
  Providing that partial derivatives of $V$ are switchable, and let $M\equiv 1 / V'$, we have that
  \begin{equation}
    \label{eq:rho t circ V}
    (\partial_t\rho)\circ V = -M(M\partial_t V)'.
  \end{equation}
  Plugging \cref{eq:rho t circ V} into the power-law nonlinear diffusion system
  \[
    \partial_t \rho = \left(D_{\rho}\rho^{\gamma - 1}\rho' - \chi\rho c'\right)'
  \]
  gives us
  \[
    \partial_t V = -\frac{D_\rho}{\gamma}(M^\gamma)' + \chi c'\circ V.
  \]

  \section{FEM}
  Given the basis $\{\phi_l\}$ of the finite subspace, the weak formulation of problem
  \[
    \left\{
      \begin{aligned}
        \partial_t c &= D_c \partial_x^2 c + R_c(\rho, c), \\
        \partial_x c &= 0\quad\text{at}\;\{a,b\}
      \end{aligned}
    \right.
  \]
  reads
  \begin{equation}
    \label{eq:sys2 weak form}
    \int_a^b \partial_t c \phi_l\diff x = - D_c\int_a^b \partial_x c\phi_l'\diff x
                                          + \int_a^b R_c(\rho, c)\phi_l\diff x,
  \end{equation}
  as
  \[
    \int_a^b \partial^2_x c\phi_l \diff x = - \int_a^b \partial_x c\phi_l'\diff x.
  \]

  Let $c(x, t) = \sum_k c_k(t)\phi_k(x)$, then \cref{eq:sys2 weak form} writes
  \[
    \sum_k c'_k(t)\int_a^b\phi_k\phi_l\diff x = - D_c\sum_k c_k(t)\int_a^b\phi_k'\phi_l'\diff x
                                                + \int_a^b R_c(\rho, c)\phi_l\diff x.
  \]

  \section{Implicit-explicit scheme}
  Suppose the PDE is $\partial_t y = f(y)$, where $f$ is an operator of $y$ (irrelevant to time
  variable $t$, not containing operations like $\partial_t$), then the scheme consists of two steps
  \[
    \left\{
      \begin{aligned}
        \frac{\tilde y - y}{\Delta t / 2} = f(\tilde y)\\
        \frac{T_{\Delta t}y - y}{\Delta t} = f(\tilde y),
      \end{aligned}
    \right.
  \]
  where $T_{\Delta t}y$ is the scheme approximation after time interval $\Delta t$.

  It is worth noting that the first step is implicit, so we apply the Newton's method to obtain
  the unknown intermediate state $\tilde y$. And if the operator $f$ contains terms that make
  it impossible to apply the Newton's method, we use $y$ instead.

  \section{Monotonicity preservation}
  For brevity we use the notation $\Delta V_{j + 1 / 2} = V_{j + 1} - V_j$,
  consider the forward Euler scheme of the form
  \begin{equation}
    \label{eq:Euler scheme}
    V_j(t + \Delta t) = V_j(t)
    + \Delta t\chi c'(V_j(t))
    - \frac{D_\rho\Delta t}{\gamma\Delta w}\left(\frac{\Delta w^\gamma}{(V_{j + 1}(t) - V_j(t))^\gamma}
      - \frac{\Delta w^\gamma}{(V_j(t) - V_{j - 1}(t))^\gamma}\right),
  \end{equation}
  then scheme is monotonicity preserving if $\exists\theta \in (0, 1)$, both CFL conditions
  \begin{subequations}
    \begin{align}
      \label{eq:CFL diffusion}
      \Delta t &< \frac{\theta}{2D_\rho \Delta w^{\gamma - 1}}
        \frac{\Delta V_{j + 1 / 2}(t)\Delta V_{j - 1 / 2}(t)}
          {\max_{k = j - 1, j}\left(\Delta V_{k + 1 / 2}(t)\right)^{-(\gamma - 1)}},
      \,\forall j \\
      \label{eq:CFL chemo}
      \Delta t &< \frac{1 - \theta}{\chi}\frac{\Delta V_{j + 1 / 2}(t)}{\left|c'(V_{j + 1}) - c'(V_j)\right|},
      \,\forall j
    \end{align}
  \end{subequations}
  are satistified.
  \begin{proof}
  We compute the difference
    \[
      \begin{aligned}
        \Delta V_{j + 1 / 2}(t + \Delta t) =& \Delta V_{j + 1 / 2}(t)
          + \Delta t\chi\left(c'(V_{j + 1}(t)) - c'(V_j(t))\right) \\
          &- \frac{\Delta tD_\rho}{\Delta w}\left(
              \frac{\left(\Delta w / \Delta V_{j + 3 / 2}(t)\right)^\gamma}{\gamma}
              - \frac{\left(\Delta w / \Delta V_{j + 1 / 2}(t)\right)^\gamma}{\gamma}
            \right) \\
          &+ \frac{\Delta tD_\rho}{\Delta w}\left(
              \frac{\left(\Delta w / \Delta V_{j + 1 / 2}(t)\right)^\gamma}{\gamma}
              - \frac{\left(\Delta w / \Delta V_{j - 1 / 2}(t)\right)^\gamma}{\gamma}
            \right).
      \end{aligned}
    \]
    By applying the mean value theorem to the function $f(x) = x^\gamma / \gamma$,
    we obtain
    \[
      \begin{aligned}
        \Delta V_{j + 1 / 2}(t + \Delta t) =& \Delta V_{j + 1 / 2}(t)
          + \Delta t\chi\left(c'(V_{j + 1}(t)) - c'(V_j(t))\right) \\
          &- \Delta tD_\rho\kappa_{j + 1}\left(
            \frac 1{\Delta V_{j + 3 / 2}(t)} - \frac 1{\Delta V_{j + 1 / 2}(t)}
            \right) \\
          &+ \Delta tD_\rho\kappa_j\left(
            \frac 1{\Delta V_{j + 1 / 2}(t)} - \frac 1{\Delta V_{j - 1 / 2}(t)}
            \right),
      \end{aligned}
    \]
    where $\kappa_j$ is between $\left(\Delta w / \Delta V_{j + 1 / 2}(t)\right)^{\gamma - 1}$
    and $\left(\Delta w / \Delta V_{j - 1 / 2}(t)\right)^{\gamma - 1}$.
    Then we define
    \[
      L_{j + 1 / 2} = \frac{c'(V_{j + 1}(t)) - c'(V'_j(t))}{V_{j + 1}(t) - V_j(t))},
    \]
    and rewrite
    \[
      \begin{aligned}
         &\Delta V_{j + 1 / 2}(t + \Delta t)\\
        =& \Delta V_{j + 1 / 2}(t)
        \left(
          1 + \Delta t\chi L_{j + 1 / 2}
          - \frac{\Delta t D_\rho\kappa_{j + 1}}{\Delta V_{j + 3 / 2}(t)\Delta V_{j + 1 / 2}(t)}
          - \frac{\Delta t D_\rho\kappa_j}{\Delta V_{j + 1 / 2}(t)\Delta V_{j - 1 / 2}(t)}
        \right)\\
         &+ \Delta t D_\rho\frac{\Delta t D_\rho(\kappa_j + \kappa_{j + 1})}{\Delta V_{j + 1 / 2}(t)}.
      \end{aligned}
    \]
    And by \cref{eq:CFL chemo} we have $1 - \Delta t\chi\left|L_{j + 1 / 2}\right| > \theta$,
    and by \cref{eq:CFL diffusion}
    \[
      \frac{\Delta t D_\rho \kappa_k}{\Delta V_{k + 1 / 2}(t)\Delta V_{k - 1 / 2}(t)}
      < \frac\theta 2,\quad k = j, j + 1.
    \]
    Hence $\Delta V_{j + 1 / 2}(t + \Delta t) > 0$ if $\Delta V_{j + 1 / 2}(t) > 0$, and scheme
    \ref{eq:Euler scheme} is monotonicity-preserving.
  \end{proof}

  For our splitting method, we avoid time step restrictions due to the diffusion terms by our
  implicit treatment and let $\theta = 0$.
\end{document}
